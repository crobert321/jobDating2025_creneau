<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <meta charset="UTF-8">
    <title>Inscription Étudiant</title>
  </head>
  <body>
    <h2>Formulaire Étudiant / Entreprise</h2>
    <form id="formulaire">
      <label>Entreprise: <input name="entreprise" required></label><br><br>
      <label>Créneau: <input name="creneau" required></label><br><br>
      <label>Nom étudiant: <input name="nom_etudiant" required></label><br><br>
      <label>Prénom étudiant: <input name="prenom_etudiant" required></label><br><br>
      <label>Email étudiant: <input type="email" name="mail_etudiant" required></label><br><br>
      <button type="submit">Envoyer</button>
    </form>

    <div id="message" style="margin-top: 20px;"></div>

    <script>
      document.getElementById("formulaire").addEventListener("submit", function(e) {
        e.preventDefault();
        const formData = new FormData(e.target);
        const data = Object.fromEntries(formData.entries());

        google.script.run
          .withSuccessHandler(function(message) {
            document.getElementById("message").innerText = message;
            document.getElementById("formulaire").reset();
          })
          .withFailureHandler(function(error) {
            document.getElementById("message").innerText = "Erreur : " + error.message;
          })
          .traiterDonnees(data);
      });
    </script>
  </body>
</html>
